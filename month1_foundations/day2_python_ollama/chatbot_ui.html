<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ollama Chat</title>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0a0a0f;
    --surface: #12121a;
    --border: #1e1e2e;
    --accent: #7c3aed;
    --accent2: #06b6d4;
    --text: #e2e8f0;
    --muted: #64748b;
    --user-bubble: #1e1b4b;
    --bot-bubble: #0f172a;
  }

  body {
    font-family: 'JetBrains Mono', monospace;
    background: var(--bg);
    color: var(--text);
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  /* Animated background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(ellipse 60% 40% at 20% 10%, rgba(124,58,237,0.12) 0%, transparent 60%),
      radial-gradient(ellipse 40% 60% at 80% 90%, rgba(6,182,212,0.08) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  header {
    padding: 16px 24px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 12px;
    background: rgba(18,18,26,0.8);
    backdrop-filter: blur(12px);
    position: relative;
    z-index: 10;
  }

  .logo {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
  }

  .header-info h1 {
    font-family: 'Syne', sans-serif;
    font-size: 16px;
    font-weight: 800;
    letter-spacing: 0.05em;
    color: #fff;
  }

  .header-info span {
    font-size: 11px;
    color: var(--muted);
  }

  .status {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: var(--muted);
  }

  .dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    background: #22c55e;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.4; }
  }

  #chat {
    flex: 1;
    overflow-y: auto;
    padding: 24px;
    display: flex;
    flex-direction: column;
    gap: 16px;
    position: relative;
    z-index: 1;
    scroll-behavior: smooth;
  }

  #chat::-webkit-scrollbar { width: 4px; }
  #chat::-webkit-scrollbar-track { background: transparent; }
  #chat::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

  .message {
    display: flex;
    gap: 10px;
    animation: fadeUp 0.3s ease;
    max-width: 80%;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .message.user {
    align-self: flex-end;
    flex-direction: row-reverse;
  }

  .avatar {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    flex-shrink: 0;
  }

  .message.user .avatar {
    background: linear-gradient(135deg, var(--accent), #9333ea);
  }

  .message.bot .avatar {
    background: linear-gradient(135deg, var(--accent2), #0284c7);
  }

  .bubble {
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 13px;
    line-height: 1.7;
    max-width: 100%;
    word-break: break-word;
  }

  .message.user .bubble {
    background: var(--user-bubble);
    border: 1px solid rgba(124,58,237,0.3);
    border-top-right-radius: 2px;
    color: #c4b5fd;
  }

  .message.bot .bubble {
    background: var(--bot-bubble);
    border: 1px solid var(--border);
    border-top-left-radius: 2px;
  }

  .typing {
    display: flex;
    gap: 4px;
    padding: 4px 0;
  }

  .typing span {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--accent2);
    animation: bounce 1.2s infinite;
  }

  .typing span:nth-child(2) { animation-delay: 0.2s; }
  .typing span:nth-child(3) { animation-delay: 0.4s; }

  @keyframes bounce {
    0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
    30% { transform: translateY(-6px); opacity: 1; }
  }

  .input-area {
    padding: 16px 24px;
    border-top: 1px solid var(--border);
    background: rgba(18,18,26,0.9);
    backdrop-filter: blur(12px);
    position: relative;
    z-index: 10;
  }

  .input-row {
    display: flex;
    gap: 10px;
    align-items: flex-end;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 10px 14px;
    transition: border-color 0.2s;
  }

  .input-row:focus-within {
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(124,58,237,0.1);
  }

  textarea {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: var(--text);
    font-family: 'JetBrains Mono', monospace;
    font-size: 13px;
    resize: none;
    max-height: 120px;
    line-height: 1.6;
  }

  textarea::placeholder { color: var(--muted); }

  button {
    width: 36px;
    height: 36px;
    border-radius: 9px;
    border: none;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    color: #fff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: opacity 0.2s, transform 0.1s;
  }

  button:hover { opacity: 0.85; }
  button:active { transform: scale(0.95); }
  button:disabled { opacity: 0.4; cursor: not-allowed; }

  .hint {
    text-align: center;
    font-size: 11px;
    color: var(--muted);
    margin-top: 8px;
  }

  .welcome {
    text-align: center;
    margin: auto;
    padding: 40px;
  }

  .welcome h2 {
    font-family: 'Syne', sans-serif;
    font-size: 28px;
    font-weight: 800;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 8px;
  }

  .welcome p {
    color: var(--muted);
    font-size: 13px;
  }
</style>
</head>
<body>

<header>
  <div class="logo">ü¶ô</div>
  <div class="header-info">
    <h1>OLLAMA CHAT</h1>
    <span>mistral ¬∑ localhost:11434</span>
  </div>
  <div class="status">
    <div class="dot"></div>
    local
  </div>
</header>

<div id="chat">
  <div class="welcome" id="welcome">
    <h2>Hello, Human.</h2>
    <p>Ask me anything. Running locally via Ollama.</p>
  </div>
</div>

<div class="input-area">
  <div class="input-row">
    <textarea id="input" placeholder="Type a message..." rows="1"></textarea>
    <button id="sendBtn" onclick="sendMessage()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <line x1="22" y1="2" x2="11" y2="13"></line>
        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
      </svg>
    </button>
  </div>
  <div class="hint">Enter to send ¬∑ Shift+Enter for new line</div>
</div>

<script>
  const OLLAMA_URL = "http://localhost:8000/chat";

  const chatEl = document.getElementById("chat");
  const inputEl = document.getElementById("input");
  const sendBtn = document.getElementById("sendBtn");
  const welcome = document.getElementById("welcome");

  // Auto-resize textarea
  inputEl.addEventListener("input", () => {
    inputEl.style.height = "auto";
    inputEl.style.height = Math.min(inputEl.scrollHeight, 120) + "px";
  });

  // Enter to send
  inputEl.addEventListener("keydown", (e) => {
    if (e.key === "Enter" && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });

  function addMessage(role, content) {
    if (welcome) welcome.style.display = "none";

    const div = document.createElement("div");
    div.className = `message ${role}`;

    const avatar = document.createElement("div");
    avatar.className = "avatar";
    avatar.textContent = role === "user" ? "üë§" : "ü§ñ";

    const bubble = document.createElement("div");
    bubble.className = "bubble";
    bubble.textContent = content;

    div.appendChild(avatar);
    div.appendChild(bubble);
    chatEl.appendChild(div);
    chatEl.scrollTop = chatEl.scrollHeight;
    return bubble;
  }

  function addTyping() {
    if (welcome) welcome.style.display = "none";
    const div = document.createElement("div");
    div.className = "message bot";
    div.id = "typing";

    const avatar = document.createElement("div");
    avatar.className = "avatar";
    avatar.textContent = "ü§ñ";

    const bubble = document.createElement("div");
    bubble.className = "bubble";
    bubble.innerHTML = '<div class="typing"><span></span><span></span><span></span></div>';

    div.appendChild(avatar);
    div.appendChild(bubble);
    chatEl.appendChild(div);
    chatEl.scrollTop = chatEl.scrollHeight;
  }

  function removeTyping() {
    const t = document.getElementById("typing");
    if (t) t.remove();
  }

  async function sendMessage() {
    const text = inputEl.value.trim();
    if (!text) return;

    addMessage("user", text);
    inputEl.value = "";
    inputEl.style.height = "auto";
    sendBtn.disabled = true;
    addTyping();

    try {
      const res = await fetch(OLLAMA_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: text })
      });

      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();
      removeTyping();
      addMessage("bot", data.response);
    } catch (err) {
      removeTyping();
      addMessage("bot", `‚ùå Error: ${err.message}. Make sure Ollama is running on localhost:11434`);
    }

    sendBtn.disabled = false;
    inputEl.focus();
  }
</script>
</body>
</html>
